
최근 회사에서 "멀티 쇼핑몰 연동" 기능이 추가되어,
유저와 쇼핑몰 계정이 1:1 관계에서 1:N 으로 변경되었다.
이에 따라 기존 저장되어 있던 MongoDb Collection 중 쇼핑몰 계정별로 
구분이 필요한 데이터에 쇼핑몰 계정 정보를 추가하고 데이터 구조를 변경 해야하는 Migration 작업이 있었다.

최초 마이그레이션 코드 작성
    Python 프로젝트를 만들어 운영 DB connection을 연결하고
    쇼핑몰 계정 정보가 추가 되어야하는 상품을 조회, 
    그리고 해당 상품 정보에 있는 계정 정보를 찾고
    Update를 해줬다

    40분 정도 소요되었다.

    문제: 운영 배포 후 마이그레이션을 40분 동안 한다면 40분 동안 운영 테스트 및 서비스를 할 수 없다.
         대안으로 해당 Collection들을 새로운 Collection에 미리 마이그레이션을 하고,
         운영 배포할 때 Import 하고 누락된 데이터를 반영해주려 했다.
         하지만, 데이터 유실 우려와 근본적인 해결책이 아니라고 생각이되었다.

두번째 방법
    MongoDB Script를 이용하여 마이그레션 코드 작성
        처음 짠 코드보다 시간은 줄었지만 30분 정도 소요되었다.

세번째 방법
    마이그레이션하는 방법을 바꿨다.
    대상 추출하고 변경정보를 반영하는 방법에서
    변경 정보들




